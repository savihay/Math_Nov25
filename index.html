<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>转专 祝 -   转拽</title>
    
    <!-- 注转 住驻专转 爪转 (专拽 注爪) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 专转 注爪 爪转 -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Rubik', sans-serif;
            background-color: #f9fafb;
            -webkit-tap-highlight-color: transparent;
        }

        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }
        .animate-fall {
            animation-name: fall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.5s ease-out;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- 驻拽爪转 注专 注专 (Shuffle) ---
        const shuffleArray = (array) => {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        };

        // --- 专 拽 (SVG) ---
        const Icons = {
            ChevronRight: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>,
            CheckCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            XCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>,
            Trophy: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17"/><path d="M14 14.66V17"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/><path d="M8.5 22v-2.08a6 6 0 0 1 .6-2.92"/></svg>,
            BookOpen: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            Calculator: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>,
            PieChart: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>,
            Star: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            RefreshCw: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>,
            ArrowLeft: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>,
            Lightbulb: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>,
            Play: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
        };

        // --- 转 ---
        const rawTopics = [
          {
            id: 'functions',
            title: '驻拽爪 拽转',
            icon: <Icons.PieChart className="w-6 h-6" />,
            color: 'bg-blue-500',
            lightColor: 'bg-blue-50',
            borderColor: 'border-blue-200',
            textColor: 'text-blue-700',
            studyMaterial: {
              title: '住: y = mx + b',
              points: [
                { title: 'm (砖驻注)', text: '住驻专 砖爪 -x.\n (+) = 注 锔\n砖 (-) = 专转 锔\n驻住 = 拽注 (拽 砖专 ).' },
                { title: 'b (转 y)', text: '住驻专 驻砖 ( 拽住). 拽注   驻拽爪 转转 转 爪专 -y.' },
                { title: '拽转 转', text: '注 爪专 y: 爪 x=0.\n注 爪专 x: 爪 y=0 驻转专 砖.' }
              ]
            },
            questions: [
              {
                type: 'multiple',
                q: '驻拽爪 y = -3x + 5,  砖驻注 (m)?',
                options: ['5', '-3', '3', '-5'],
                correct: '-3',
                explanation: '砖驻注 (m)  转 住驻专 砖爪 -x,  住 砖.'
              },
              {
                type: 'multiple',
                q: ' 驻拽爪 y = 4x - 2 注  专转?',
                options: ['注', '专转', '拽注', ' 转 注转'],
                correct: '注',
                explanation: '砖驻注 (4)  ,  驻拽爪 注.'
              },
              {
                type: 'multiple',
                q: ' 拽转 转 砖 驻拽爪 y = 2x - 6 注 爪专 -y?',
                options: ['(0, -6)', '(0, 6)', '(-6, 0)', '(0, 2)'],
                correct: '(0, -6)',
                explanation: '转 注 爪专 y -x 砖 0, -y 砖 -b (住驻专 驻砖).'
              },
              {
                type: 'multiple',
                q: ' 拽 爪转 注 砖专 y = x + 2?',
                options: ['(2, 4)', '(1, 4)', '(3, 4)', '(0, 0)'],
                correct: '(2, 4)',
                explanation: '爪 x=2 砖: y = 2+2, 专 y=4. 拽 (2,4) 转.'
              },
              {
                type: 'multiple',
                q: '转 驻拽爪 y = -5.  住 驻拽爪 ?',
                options: ['拽注', '注', '专转', ' 驻拽爪'],
                correct: '拽注',
                explanation: ' x 砖 (砖驻注  0),  驻拽爪 拽注 转 砖 -5-.'
              },
              {
                type: 'multiple',
                q: ' 砖驻注 砖 驻拽爪 y = 8 - 2x?',
                options: ['-2', '8', '2', '-8'],
                correct: '-2',
                explanation: '砖  住专! 砖驻注  转 住驻专 砖爪 -x.   2-.'
              },
              {
                type: 'multiple',
                q: '专  拽 注专 砖专 y = 3x?',
                options: ['(0, 0)', '(0, 3)', '(3, 0)', '(1, 1)'],
                correct: '(0, 0)',
                explanation: '驻拽爪 爪专 y=mx ( b) 转 注专转 专砖转 爪专 (0,0).'
              }
            ]
          },
          {
            id: 'equations',
            title: '砖转',
            icon: <Icons.Calculator className="w-6 h-6" />,
            color: 'bg-green-500',
            lightColor: 'bg-green-50',
            borderColor: 'border-green-200',
            textColor: 'text-green-700',
            studyMaterial: {
              title: '拽 驻转专 ',
              points: [
                { title: '住专 驻注转', text: '1. 驻转转 住专\n2. 注专转 驻 (住驻专 爪 , 拽住 砖)\n3. 住 专\n4. 拽 拽 砖 x.' },
                { title: '专转 - 住!', text: '住 驻 住专 驻 转  住 驻. : \n-(x+2) \n驻 : \n-x - 2' },
                { title: '注专转 驻', text: '砖注专 专 爪 爪 砖 "砖", 住 砖 砖转 (驻住 驻 住 驻).' }
              ]
            },
            questions: [
              {
                type: 'input',
                q: '驻转专 转 砖: 2x - 4 = 10 (转 专拽 转 住驻专)',
                correct: '7',
                explanation: '注专 转 -4 祝: 2x = 14. 拽 -2 拽 x=7.'
              },
              {
                type: 'multiple',
                q: ' 砖 专砖 驻转专 砖 3(x - 2) = 9?',
                options: ['驻转 住专', '注专 转 9 祝', '拽 -x', '住专 3'],
                correct: '驻转 住专',
                explanation: '驻 住专 驻注转 砖, 拽 驻转 住专: 3x - 6 = 9.'
              },
              {
                type: 'multiple',
                q: '驻转专: 5x = 2x + 15',
                options: ['5', '3', '15', '-5'],
                correct: '5',
                explanation: '注专 转 2x 祝 住专: 3x = 15. 拽 -3 拽 x=5.'
              },
              {
                type: 'multiple',
                q: ' 转爪 砖 驻转转 住专: -2(x - 4)?',
                options: ['-2x + 8', '-2x - 8', '-2x - 4', '2x + 8'],
                correct: '-2x + 8',
                explanation: '住 驻 住 转 驻住! 2- 驻 4-  8+.'
              },
              {
                type: 'input',
                q: '驻转专: x + 5 = -2 (转 转 住驻专)',
                correct: '-7',
                explanation: '注专 转 -5 祝 (驻 住): x = -2 - 5,  x = -7.'
              },
              {
                type: 'multiple',
                q: ' 砖 转 砖驻: "住驻专 驻 3 注 2 砖 -17"?',
                options: ['3x + 2 = 17', '3(x + 2) = 17', 'x + 3 + 2 = 17', '2x + 3 = 17'],
                correct: '3x + 2 = 17',
                explanation: '住驻专 (x) 驻 3 (3x) 注 2 (+2) 砖 -17.'
              }
            ]
          },
          {
            id: 'geometry',
            title: '专 驻驻',
            icon: <Icons.BookOpen className="w-6 h-6" />,
            color: 'bg-purple-500',
            lightColor: 'bg-purple-50',
            borderColor: 'border-purple-200',
            textColor: 'text-purple-700',
            studyMaterial: {
              title: '  驻驻?',
              points: [
                { title: '砖驻 爪..爪', text: '砖转 爪注转 砖转 转 *砖* 砖.' },
                { title: '砖驻 .爪.', text: '砖转 转 砖转 爪注 *砖* 砖.' },
                { title: '砖驻 爪.爪.爪', text: ' 砖砖 爪注转 砖转 转.' },
                { title: '转 ', text: '驻砖 "砖注 " (转 拽拽转 砖转)  爪注 砖转驻转.' }
              ]
            },
            questions: [
              {
                type: 'multiple',
                q: '转 砖 砖砖 砖 砖转 爪注转 砖转 转   砖. 驻  砖驻  驻驻?',
                options: ['爪..爪', '.爪.', '爪.爪.爪', ' 驻驻'],
                correct: '爪..爪',
                explanation: '转 : 爪注, 转 , 爪注 住驻转.  拽 砖驻 爪..爪.'
              },
              {
                type: 'multiple',
                q: '转 砖 砖砖 爪注转 砖砖  砖转 爪注转 砖砖 砖.  砖驻 驻驻 ?',
                options: ['爪.爪.爪', '爪..爪', '.爪.', '祝 '],
                correct: '爪.爪.爪',
                explanation: '砖专 专拽 爪注转 注转 砖,  砖驻 爪.爪.爪.'
              },
              {
                type: 'multiple',
                q: '爪专 砖 砖 拽 砖专 砖转 (爪专 X),    转 砖爪转 转  砖?',
                options: [' 砖转 (拽拽转)', '住 180', ' 砖转', '住 90'],
                correct: ' 砖转 (拽拽转)',
                explanation: '转 拽拽转 转 砖转  .'
              },
              {
                type: 'multiple',
                q: ' 转 砖砖砖 ABC 驻祝 砖砖 DEF,  爪注 砖 爪注 BC?',
                options: ['EF', 'DE', 'DF', 'AB'],
                correct: 'EF',
                explanation: '驻 住专 转转: BC  转转 砖 砖砖转,  转转 -EF (砖 砖砖转 砖砖 砖).'
              },
              {
                type: 'multiple',
                q: '砖砖 砖 砖拽,  转 砖转  ?',
                options: ['转 住住', '转 专砖 转 住住', ' 转 砖转', ' 转 砖转'],
                correct: '转 住住',
                explanation: '砖砖 砖 砖拽, 转 砖 住住 ( 砖拽 砖转) 转 砖转.'
              },
              {
                type: 'multiple',
                q: ' 住 转  砖砖?',
                options: ['180 注转', '90 注转', '360 注转', '100 注转'],
                correct: '180 注转',
                explanation: '砖驻 住: 住 转  砖砖  转 180 注转.'
              }
            ]
          },
          {
            id: 'ratio',
            title: '住 驻专驻专爪',
            icon: <Icons.Star className="w-6 h-6" />,
            color: 'bg-orange-500',
            lightColor: 'bg-orange-50',
            borderColor: 'border-orange-200',
            textColor: 'text-orange-700',
            studyMaterial: {
              title: '砖转 砖',
              points: [
                { title: '1. 专', text: '专 转 住驻专 住 (砖 2:3  5 转 住").' },
                { title: '2. 拽', text: '拽 转 砖 拽 住 砖爪.  爪  砖 " 转".' },
                { title: '3. 驻', text: '驻 转 砖 砖  转   拽 住 拽专.' }
              ]
            },
            questions: [
              {
                type: 'input',
                q: '住   转  2:3.  转 住 砖 住"?',
                correct: '5',
                explanation: '专 转 住驻专: 2 + 3 = 5.'
              },
              {
                type: 'input',
                q: '拽 20 住专转 住 砖 1:4.  住专转 拽  注 拽 拽?',
                correct: '4',
                explanation: '住" 5 转 住.   砖 4 (20 拽 -5). 拽 拽  1 ( 转) 驻 4.'
              },
              {
                type: 'multiple',
                q: ' 住  拽 住专  2:1, 砖 300 专 转注专转.  专 住专 砖?',
                options: ['100', '200', '150', '50'],
                correct: '100',
                explanation: '住" 3 转 (2+1).   砖 100 (300/3). 住专   转,  100 专.'
              },
              {
                type: 'multiple',
                q: ' 住 砖 住 10:20?',
                options: ['1:2', '1:3', '2:1', '1:5'],
                correct: '1:2',
                explanation: ' 爪爪 转 砖 住驻专 -10 (拽 -10), 拽 1 -2.'
              }
            ]
          }
        ];

        const Confetti = () => (
          <div className="fixed inset-0 pointer-events-none z-50 flex justify-center items-start overflow-hidden">
            {[...Array(20)].map((_, i) => (
              <div
                key={i}
                className="absolute animate-fall"
                style={{
                  left: `${Math.random() * 100}%`,
                  animationDuration: `${Math.random() * 3 + 2}s`,
                  animationDelay: `${Math.random() * 2}s`
                }}
              >
                <Icons.Star fill={['#FFD700', '#FF69B4', '#00CED1', '#32CD32'][Math.floor(Math.random() * 4)]} className="w-4 h-4 text-transparent" />
              </div>
            ))}
          </div>
        );

        function MathApp() {
          const [view, setView] = useState('menu'); // menu, study, quiz, completed
          const [currentTopic, setCurrentTopic] = useState(null);
          const [questions, setQuestions] = useState([]);
          const [questionIndex, setQuestionIndex] = useState(0);
          const [score, setScore] = useState(0);
          const [showFeedback, setShowFeedback] = useState(false);
          const [isCorrect, setIsCorrect] = useState(false);
          const [inputValue, setInputValue] = useState('');
          const [completedTopics, setCompletedTopics] = useState([]);

          const handleTopicSelect = (topic) => {
            // 爪专转 注转拽 注拽 砖 砖转 注专 转砖转
            const shuffledQuestions = topic.questions.map(q => {
              if (q.type === 'multiple') {
                return { ...q, options: shuffleArray(q.options) };
              }
              return q;
            });

            // 注专 住专 砖转
            const finalQuestions = shuffleArray(shuffledQuestions);

            setCurrentTopic(topic);
            setQuestions(finalQuestions);
            setQuestionIndex(0);
            setScore(0);
            setShowFeedback(false);
            setInputValue('');
            setView('study');
          };

          const startQuiz = () => {
            setView('quiz');
          };

          const handleAnswer = (answer) => {
            if (showFeedback) return;
            
            const correct = questions[questionIndex].correct;
            const isRight = answer.toString().trim() === correct.toString().trim();
            
            setIsCorrect(isRight);
            if (isRight) setScore(score + 1);
            setShowFeedback(true);
          };

          const nextQuestion = () => {
            if (questionIndex < questions.length - 1) {
              setQuestionIndex(questionIndex + 1);
              setShowFeedback(false);
              setInputValue('');
              setIsCorrect(false);
            } else {
              if (!completedTopics.includes(currentTopic.id)) {
                setCompletedTopics([...completedTopics, currentTopic.id]);
              }
              setView('completed');
            }
          };

          const resetApp = () => {
            setCurrentTopic(null);
            setQuestions([]);
            setQuestionIndex(0);
            setView('menu');
          };

          // Main Menu View
          if (view === 'menu') {
            return (
              <div className="min-h-screen p-4">
                <div className="max-w-md mx-auto">
                  <header className="mb-8 text-center pt-4">
                    <h1 className="text-3xl font-bold text-gray-800 mb-2">转专 祝 </h1>
                    <p className="text-gray-600">  转拽 - 转 '</p>
                    <div className="mt-4 flex justify-center gap-2">
                      <span className="text-sm bg-white px-3 py-1 rounded-full shadow-sm border border-gray-200 text-gray-600">
                        砖: {completedTopics.length}/{rawTopics.length}
                      </span>
                    </div>
                  </header>

                  <div className="grid gap-4 pb-8">
                    {rawTopics.map((topic) => (
                      <button
                        key={topic.id}
                        onClick={() => handleTopicSelect(topic)}
                        className={`relative overflow-hidden p-6 rounded-2xl shadow-sm hover:shadow-md transition-all bg-white text-right group border border-transparent hover:border-gray-100`}
                      >
                        <div className={`absolute inset-y-0 left-0 w-2 ${topic.color}`}></div>
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-4">
                            <div className={`p-3 rounded-xl ${topic.lightColor} ${topic.textColor} group-hover:scale-110 transition-transform`}>
                              {topic.icon}
                            </div>
                            <div>
                              <h3 className="font-bold text-lg text-gray-800 group-hover:text-blue-600 transition-colors">{topic.title}</h3>
                              <p className="text-sm text-gray-500">{topic.questions.length} 砖转</p>
                            </div>
                          </div>
                          {completedTopics.includes(topic.id) ? (
                            <Icons.CheckCircle className="w-6 h-6 text-green-500" />
                          ) : (
                            <Icons.ChevronRight className="w-6 h-6 text-gray-300" />
                          )}
                        </div>
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            );
          }

          // Study View
          if (view === 'study' && currentTopic) {
            return (
              <div className="min-h-screen p-4">
                <div className="max-w-md mx-auto flex flex-col h-full">
                  {/* Header */}
                  <div className="flex items-center gap-4 mb-6">
                    <button onClick={resetApp} className="p-2 rounded-full hover:bg-gray-200 transition-colors">
                      <Icons.ArrowLeft className="w-6 h-6 text-gray-600" />
                    </button>
                    <h2 className="text-xl font-bold text-gray-800">专 注 专</h2>
                  </div>

                  {/* Content Card */}
                  <div className="bg-white rounded-3xl shadow-sm border border-gray-100 overflow-hidden mb-6 flex-1">
                    <div className={`${currentTopic.color} p-6 text-white`}>
                      <div className="flex items-center gap-3 mb-2">
                        <Icons.Lightbulb className="w-6 h-6 text-yellow-300" />
                        <span className="font-bold opacity-90">祝 专</span>
                      </div>
                      <h1 className="text-2xl font-bold">{currentTopic.studyMaterial.title}</h1>
                    </div>
                    
                    <div className="p-6 space-y-6">
                      {currentTopic.studyMaterial.points.map((point, idx) => (
                        <div key={idx} className="flex gap-4">
                          <div className={`w-8 h-8 rounded-full flex items-center justify-center shrink-0 font-bold text-sm ${currentTopic.lightColor} ${currentTopic.textColor}`}>
                            {idx + 1}
                          </div>
                          <div>
                            <h3 className="font-bold text-gray-800 mb-1">{point.title}</h3>
                            <p className="text-gray-600 text-sm leading-relaxed whitespace-pre-line">{point.text}</p>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Start Button */}
                  <button
                    onClick={startQuiz}
                    className={`w-full py-4 rounded-xl font-bold text-white shadow-lg transition-transform active:scale-95 flex items-center justify-center gap-2 ${currentTopic.color}`}
                  >
                    <Icons.Play className="w-5 h-5 fill-current" />
                    转 转专
                  </button>
                </div>
              </div>
            );
          }

          // Completion View
          if (view === 'completed') {
            return (
              <div className="min-h-screen p-4 flex items-center justify-center">
                <Confetti />
                <div className="bg-white p-8 rounded-3xl shadow-xl text-center max-w-sm w-full relative overflow-hidden animate-fade-in-up">
                  <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 to-purple-500"></div>
                  <div className="mb-6 flex justify-center">
                    <Icons.Trophy className="w-20 h-20 text-yellow-400 drop-shadow-lg animate-bounce" />
                  </div>
                  <h2 className="text-2xl font-bold text-gray-800 mb-2"> !</h2>
                  <p className="text-gray-600 mb-6">住转 转  爪!</p>
                  <div className="text-4xl font-bold text-blue-600 mb-8">{score} / {questions.length}</div>
                  <button
                    onClick={resetApp}
                    className="w-full py-3 px-6 bg-gray-900 text-white rounded-xl font-medium hover:bg-gray-800 transition-colors flex items-center justify-center gap-2"
                  >
                    <Icons.RefreshCw className="w-4 h-4" />
                    专 转驻专 专砖
                  </button>
                </div>
              </div>
            );
          }

          // Quiz View
          const currentQ = questions[questionIndex];
          const progress = ((questionIndex) / questions.length) * 100;

          return (
            <div className="min-h-screen p-4 font-sans">
              <div className="max-w-md mx-auto h-full flex flex-col">
                
                {/* Header */}
                <div className="flex items-center justify-between mb-6">
                  <button onClick={() => setView('study')} className="p-2 rounded-full hover:bg-gray-200 transition-colors">
                    <Icons.ArrowLeft className="w-6 h-6 text-gray-600" />
                  </button>
                  <span className="font-bold text-gray-700">{currentTopic.title}</span>
                  <div className="w-8"></div> 
                </div>

                {/* Progress Bar */}
                <div className="w-full bg-gray-200 rounded-full h-2 mb-8 overflow-hidden">
                  <div 
                    className={`h-2 rounded-full transition-all duration-500 ${currentTopic.color}`} 
                    style={{ width: `${progress}%` }}
                  ></div>
                </div>

                {/* Question Card */}
                <div className="flex-1 flex flex-col">
                  <div className="bg-white rounded-3xl shadow-sm p-6 mb-6 border border-gray-100">
                    <span className="text-sm text-gray-400 font-medium mb-2 block">砖 {questionIndex + 1} 转 {questions.length}</span>
                    <h2 className="text-xl font-bold text-gray-800 leading-relaxed">{currentQ.q}</h2>
                  </div>

                  {/* Options / Input */}
                  <div className="space-y-3">
                    {currentQ.type === 'multiple' ? (
                      currentQ.options.map((opt, idx) => (
                        <button
                          key={idx}
                          disabled={showFeedback}
                          onClick={() => handleAnswer(opt)}
                          className={`w-full p-4 text-right rounded-xl border-2 transition-all duration-200 font-medium
                            ${showFeedback 
                              ? opt === currentQ.correct 
                                ? 'bg-green-50 border-green-500 text-green-700' 
                                : opt === inputValue ? 'bg-red-50 border-red-200 text-red-400' : 'bg-white border-gray-100 opacity-50'
                              : 'bg-white border-transparent shadow-sm hover:border-blue-200 hover:bg-blue-50 text-gray-700'
                            }`}
                        >
                          {opt}
                        </button>
                      ))
                    ) : (
                      <div className="relative">
                        <input
                          type="text"
                          disabled={showFeedback}
                          value={inputValue}
                          onChange={(e) => setInputValue(e.target.value)}
                          placeholder="拽 转砖..."
                          className="w-full p-4 rounded-xl border-2 border-gray-200 text-lg focus:border-blue-500 focus:outline-none text-center"
                        />
                        {!showFeedback && inputValue && (
                          <button 
                            onClick={() => handleAnswer(inputValue)}
                            className="mt-4 w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700"
                          >
                            拽 转砖
                          </button>
                        )}
                      </div>
                    )}
                  </div>

                  {/* Feedback Area */}
                  {showFeedback && (
                    <div className={`mt-6 p-4 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-100' : 'bg-red-50 border border-red-100'} animate-fade-in-up`}>
                      <div className="flex items-center gap-3 mb-2">
                        {isCorrect ? (
                          <Icons.CheckCircle className="w-6 h-6 text-green-500" />
                        ) : (
                          <Icons.XCircle className="w-6 h-6 text-red-500" />
                        )}
                        <span className={`font-bold ${isCorrect ? 'text-green-700' : 'text-red-700'}`}>
                          {isCorrect ? '爪拽转!  ' : ' 专, 住 砖'}
                        </span>
                      </div>
                      <p className="text-gray-600 text-sm leading-relaxed pr-9">
                        {currentQ.explanation}
                      </p>
                      <button
                        onClick={nextQuestion}
                        className={`mt-4 w-full py-3 rounded-lg font-bold text-white transition-transform active:scale-95 ${isCorrect ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-800 hover:bg-gray-900'}`}
                      >
                        {questionIndex < questions.length - 1 ? '砖 ' : '住 '}
                      </button>
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MathApp />);
    </script>
</body>
</html>